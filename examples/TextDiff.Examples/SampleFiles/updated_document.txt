function calculateTax(price, rate) {
    if (price <= 0 || rate < 0) {
        return 0;
    }

    var tax = price * rate;
   // Ensure tax is not negative
   tax = Math.max(0, tax);
    return tax;
}

function formatCurrency(amount) {
   if (typeof amount !== 'number' || isNaN(amount)) {
       return "$0.00";
   }
    return "$" + amount.toFixed(2);
}

function processOrder(order) {
    var subtotal = order.items.reduce((sum, item) => sum + item.price, 0);
    var tax = calculateTax(subtotal, 0.08);
    var total = subtotal + tax;

    return {
        subtotal: formatCurrency(subtotal),
        tax: formatCurrency(tax),
        total: formatCurrency(total)
    };
}